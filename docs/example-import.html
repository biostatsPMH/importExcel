<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Example Import | Using the Excel dataChecker macro and the importExcel package</title>
  <meta name="description" content="Example Import | Using the Excel dataChecker macro and the importExcel package" />
  <meta name="generator" content="bookdown 0.41.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Example Import | Using the Excel dataChecker macro and the importExcel package" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Example Import | Using the Excel dataChecker macro and the importExcel package" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-importexcel-package.html"/>
<link rel="next" href="sec-sample-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li> &nbsp;&nbsp; exceldata    </li>
<li> &nbsp;&nbsp; PMH Biostatistics</li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="" data-path="workflow-development.html"><a href="workflow-development.html"><i class="fa fa-check"></i>Workflow Development</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i>Setup</a>
<ul>
<li class="chapter" data-level="" data-path="setup.html"><a href="setup.html#installing-the-package"><i class="fa fa-check"></i>Installing the package</a></li>
<li class="chapter" data-level="" data-path="installing-the-excel-macro.html"><a href="installing-the-excel-macro.html"><i class="fa fa-check"></i>Installing the Excel Macro</a></li>
<li class="chapter" data-level="" data-path="creating-your-personal-workbook.html"><a href="creating-your-personal-workbook.html"><i class="fa fa-check"></i>Creating your Personal Workbook</a></li>
<li class="chapter" data-level="" data-path="adding-the-macro-to-your-personal-workbook.html"><a href="adding-the-macro-to-your-personal-workbook.html"><i class="fa fa-check"></i>Adding the Macro to your Personal Workbook</a></li>
<li class="chapter" data-level="" data-path="check-the-installation.html"><a href="check-the-installation.html"><i class="fa fa-check"></i>Check the Installation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i>Workflow</a>
<ul>
<li class="chapter" data-level="" data-path="using-the-checkdata-macro.html"><a href="using-the-checkdata-macro.html"><i class="fa fa-check"></i>Using the CheckData Macro</a>
<ul>
<li class="chapter" data-level="" data-path="using-the-checkdata-macro.html"><a href="using-the-checkdata-macro.html#to-run-the-macro"><i class="fa fa-check"></i>To Run the Macro</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="editing-the-dictionary-sheet.html"><a href="editing-the-dictionary-sheet.html"><i class="fa fa-check"></i>Editing the Dictionary Sheet</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-importexcel-package.html"><a href="the-importexcel-package.html"><i class="fa fa-check"></i>The importExcel Package</a>
<ul>
<li class="chapter" data-level="" data-path="example-import.html"><a href="example-import.html"><i class="fa fa-check"></i>Example Import</a></li>
<li class="chapter" data-level="" data-path="sec-sample-data.html"><a href="sec-sample-data.html"><i class="fa fa-check"></i>Sample Data</a></li>
</ul></li>
<li class="divider"></li>
<li> <a href="mailto:lisa.avery@uhn.ca">Lisa Avery</a>   </li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using the Excel dataChecker macro and the importExcel package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-import" class="section level2 hasAnchor">
<h2>Example Import<a href="example-import.html#example-import" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You need to provide the function with the location (path and filename) of the Excel file, the name of the sheet containing the data and the name of the sheet containing the dictionary.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="example-import.html#cb3-1" tabindex="-1"></a><span class="fu">library</span>(importExcel)</span>
<span id="cb3-2"><a href="example-import.html#cb3-2" tabindex="-1"></a>data_file <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;study_data.xlsx&quot;</span>, <span class="at">package =</span> <span class="st">&quot;importExcel&quot;</span>)</span>
<span id="cb3-3"><a href="example-import.html#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="example-import.html#cb3-4" tabindex="-1"></a><span class="co"># This will read in the file, add variable labels and recode variables to </span></span>
<span id="cb3-5"><a href="example-import.html#cb3-5" tabindex="-1"></a><span class="co"># factors as specified in the dictionary sheet</span></span>
<span id="cb3-6"><a href="example-import.html#cb3-6" tabindex="-1"></a>file_import <span class="ot">&lt;-</span> <span class="fu">read_excel_with_dictionary</span>(<span class="at">data_file =</span> data_file,</span>
<span id="cb3-7"><a href="example-import.html#cb3-7" tabindex="-1"></a>                                          <span class="at">data_sheet =</span> <span class="st">&quot;data&quot;</span>,<span class="at">dictionary_sheet =</span> <span class="st">&quot;dict&quot;</span>)</span>
<span id="cb3-8"><a href="example-import.html#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="example-import.html#cb3-9" tabindex="-1"></a><span class="co"># extract the recoded-data</span></span>
<span id="cb3-10"><a href="example-import.html#cb3-10" tabindex="-1"></a>coded_data <span class="ot">&lt;-</span> file_import<span class="sc">$</span>coded_data</span>
<span id="cb3-11"><a href="example-import.html#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="example-import.html#cb3-12" tabindex="-1"></a>file_import contains the following objects<span class="sc">:</span></span>
<span id="cb3-13"><a href="example-import.html#cb3-13" tabindex="-1"></a><span class="co"># check warnings</span></span>
<span id="cb3-14"><a href="example-import.html#cb3-14" tabindex="-1"></a>file_import<span class="sc">$</span>warnings</span>
<span id="cb3-15"><a href="example-import.html#cb3-15" tabindex="-1"></a></span>
<span id="cb3-16"><a href="example-import.html#cb3-16" tabindex="-1"></a><span class="co"># check for text omitted from numeric data</span></span>
<span id="cb3-17"><a href="example-import.html#cb3-17" tabindex="-1"></a>file_import<span class="sc">$</span>numeric_converstions</span>
<span id="cb3-18"><a href="example-import.html#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="example-import.html#cb3-19" tabindex="-1"></a><span class="co"># check for attempted date conversions</span></span>
<span id="cb3-20"><a href="example-import.html#cb3-20" tabindex="-1"></a>file_import<span class="sc">$</span>date_converstions</span>
<span id="cb3-21"><a href="example-import.html#cb3-21" tabindex="-1"></a></span>
<span id="cb3-22"><a href="example-import.html#cb3-22" tabindex="-1"></a><span class="co"># Look at the dictionary used</span></span>
<span id="cb3-23"><a href="example-import.html#cb3-23" tabindex="-1"></a>file_import<span class="sc">$</span>updated_dictionary</span></code></pre></div>
<p>Describe the coded data:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="example-import.html#cb4-1" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb4-2"><a href="example-import.html#cb4-2" tabindex="-1"></a><span class="fu">require</span>(reportRmd)</span>
<span id="cb4-3"><a href="example-import.html#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="example-import.html#cb4-4" tabindex="-1"></a>coded_data <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="example-import.html#cb4-5" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>studyID) <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="example-import.html#cb4-6" tabindex="-1"></a>  <span class="fu">rm_compactsum</span>(<span class="at">xvars=</span><span class="fu">everything</span>())</span></code></pre></div>
<pre><code>## no statistical tests will be applied to date variables, date variables will be summarised with median</code></pre>
<table class="table table" style="margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Full Sample (n=100)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">Age at diagnosis</span>
</td>
<td style="text-align:right;">
44.0 (32.0-57.2)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">sex - Male</span>
</td>
<td style="text-align:right;">
45 (45%)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">BMI</span>
</td>
<td style="text-align:right;">
29.0 (23.4-34.2)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">heart rate (bmp)</span>
</td>
<td style="text-align:right;">
84.0 (72.0-92.0)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">date of diagnosis</span>
</td>
<td style="text-align:right;">
2021-11-12 (2020-11-18 to 2023-06-18)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">date of randomisation</span>
</td>
<td style="text-align:right;">
2023-06-25 (2023-04-18 to 2023-08-30)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">ECOG</span>
</td>
<td style="text-align:right;">
1.0 (0.0-3.0)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">Treatment</span>
</td>
<td style="text-align:right;">
47 (47%)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">baseline score</span>
</td>
<td style="text-align:right;">
61.5 (27.5-76.2)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">final score</span>
</td>
<td style="text-align:right;">
42.5 (18.5-81.5)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">hospital</span>
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PMH
</td>
<td style="text-align:right;">
35 (35%)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Western
</td>
<td style="text-align:right;">
33 (33%)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Krembil
</td>
<td style="text-align:right;">
32 (32%)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span style="font-weight: bold;">Diagnosis</span>
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
lupus
</td>
<td style="text-align:right;">
24 (24%)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mumps
</td>
<td style="text-align:right;">
24 (24%)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
measles
</td>
<td style="text-align:right;">
31 (31%)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
rubella
</td>
<td style="text-align:right;">
21 (21%)
</td>
</tr>
</tbody>
</table>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-importexcel-package.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-sample-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none",
"toc_depth": 3,
"scroll_highlight": true
},
"info": false
});
});
</script>

</body>

</html>
